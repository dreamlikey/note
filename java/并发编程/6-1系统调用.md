用户态

user 

内核态

kernel



系统调用

用户态通过系统调用（软中断/80中断）切换到内核态

### Lock指令

保证原子性、可见性





#### 缓存行

缓存行的大小根据CPU的不同可能是32byte、64byte、128byte，通常是64byte。



#### 总线锁

CPU操作线程访问内存数据的时候，会向总线上发送一个LOCK指令，达到该处理器独享此内存的目的。可以理解为，将CPU和主内存之间的通信锁住，把并行操作变成串行化，阻塞其它CPU对该内存的访问，直到锁释放，存在严重的性能问题。

随着技术的发展，出现了性能更优的技术方案 ，缓存锁



#### 缓存锁

锁住缓存行，通过缓存一致性协议达到多缓存的数据一致



缓存一致性协议

