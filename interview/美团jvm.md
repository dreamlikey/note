锁、jvm、mysql



## 1、对象的创建过程(半初始化)

0 new #2 <com/wdq/Test>
4 invokespecial #3 <com/wdq/Test.<init>>   构造方法
7 astore_1         对象引用 指向 对象内存地址
8 return



## 2、DCL与volatile问题（指令重排）

## 3、对象在内存中的存储布局

## 4、对象头具体包括什么内容？synchronized锁信息

对象头：markword klasspointer



锁分类：

无锁、偏向锁、轻量级锁、重量级锁

轻量级锁：自旋申请锁， 用户态（jvm）中完成，线程自旋消耗CPU



重量级锁：





## 5、对象怎么定位

句柄方式

指针方式

## 6、对象怎么分配？

**优先栈上分配**

​	对象没有溢出/逃逸（线程私有）

​    标量替换 

   栈贞弹出对象消失不需要GC所以速度快



**大对象放old区**

**小对象线程本地分配**



**eden区**

年龄最大15，超过最大年龄放到老年代

为什么最大年龄是15？

对象的年龄放在markword中占4位最大2^4-1



## 7、一个Object占多少字节

是否开启压缩

压缩类指针

压缩普通对象指针



64位虚拟机上 一个对象引用占64位8个字节，由于开启了类指针压缩所以变成了4个字节



**什么时候不压缩？**

4个字节的最大内存寻址空间4G（2^32 ）

如果服务器内存空间大于4G，4个字节表示的对象地址无法包含所有的内存地址，这时就不能进行指针压缩









