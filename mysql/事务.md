### 日志

binlog

undo log

redo log

relay log

error log

慢查询日志

### 事务的特点（ACID）

#### **原子性** 

要么全部成功，要么全部失败

##### 实现原理

undo log回滚日志

#### 隔离性

并发事务不相互影响

#### 持久性

redo log

事务一旦提交，其对数据库的更新就是持久的，

任何事务或系统故障数据都不能丢失

#### 一致性

**对数据可见性的一种约束**

事务对数据进行修改时，其它事务只对开始 和最终状态可见， 对该事务的中间状态不可见

### 锁

共享

排它

组件

间隙锁

临键



### mvcc

多版本并发控制，主要是为了提高并发读写性能，不用加锁就能让多个事务并发读写。



#### 事务版本链



#### readview

mysql执行查询sql时会生成一致性视图read-view，主要包含4个重要内容：

1、m_ids：表示生成识图时所有未提交事务的事务id列表

2、min_trx_id ：最小事务id，当前未提交事务中的最小事务id

3、max_trx_id ：最大事务id（包含已提交、未提交、位开始的事务）

4、creator_trx_id ： 生成该readView的事务的事务id



对于Read Uncommited隔离级别来说直接读取最新的数据，Serializable隔离级别的事务，使用加锁的方式来访问

**Read Commited**事务隔离级别的实现方式

每次读取数据前都生成一个ReadView

**Repeatable read**实现方式

第一次读取数据时生成一个ReadView





有了这个ReadView，这样在访问某条记录时，只需要按照下边的步骤判断记录的某个版本是否可见：

1. 如果被访问版本的trx_id属性值与ReadView中的creator_trx_id值相同，意味着当前事务在访问它自己修改过的记录，所以该版本可以被当前事务访问。
2. 如果被访问版本的trx_id属性值小于ReadView中的min_trx_id值，表明生成该版本的事务在当前事务生成ReadView前已经提交，所以该版本可以被当前事务访问。
3. 如果被访问版本的trx_id属性值大于ReadView中的max_trx_id值，表明生成该版本的事务在当前事务生成ReadView后才开启，所以该版本不可以被当前事务访问。如果被访问版本的trx_id属性值在ReadView的min_trx_id和max_trx_id之间，那就需要判断一下
4. trx_id属性值是不是在m_ids列表中，如果在，说明创建ReadView时生成该版本的事务还是活跃的，该版本不可以被访问；如果不在，说明创建ReadView时生成该版本的事务已经被提交，该版本可以被访问。