#### 数据切分

##### 垂直切分

​	不同的表切分到不同的数据库（主机）上

![1563846626121](C:\Users\jiachao\AppData\Roaming\Typora\typora-user-images\1563846626121.png)



虽然垂直切分将系统单库按照不同的业务划分拆分成多库，每个业务对应一个数据库。但是对于大型系统来说，往往单库也不能满足业务系统对数据库性能要求。

缺点：

1.  拆分后业务清晰，拆分规则明确；
2. 依然存在单库性能瓶颈，大数据量和访问量的表性能瓶颈没有得到解决;

优点： 

1. 相对水平切分，数据维护简单
2. 部分业务表无法 join，只能通过接口方式解决，提高了系统复杂度；

​	

##### 水平切分

​	同一张表中的数据按照某种规则切分到不同的数据库（主机）上

![](C:\Users\jiachao\AppData\Roaming\Typora\typora-user-images\1563847172010.png)

###### 拆分规则

关系数据库是行列的二维模型，拆分的第一原则是找到拆分纬度

几种典型的分片规则包括：
• 按照用户 ID 求模，将数据分散到不同的数据库，具有相同数据用户的数据都被分散到一个库中；
• 按照日期，将不同月甚至日的数据分散到不同的库中；
• 按照某个特定的字段求摸，或者根据特定范围段分散到不同的库中。

![1563847698541](C:\Users\jiachao\AppData\Roaming\Typora\typora-user-images\1563847698541.png)



缺点：

1. 增加系统复杂度，数据维护较为困难
2. 夸库join查询性能较差
3. 分片事务一致性难以解决







#### mycat

##### 配置

三个核心配置

<https://github.com/MyCATApache/Mycat-Server/wiki/4.0-%E9%80%BB%E8%BE%91%E5%BA%93%E3%80%81%E7%B3%BB%E7%BB%9F%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%EF%BC%88server.xml%EF%BC%89>

server.xml  逻辑库、系统参数配置

schcema.xml 逻辑库、表分片配置

​	哪些表分片到哪些数据库

rule.xml  表分片规则配置

​	表具体分片规则